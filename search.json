[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Concepts of Paleoecology",
    "section": "",
    "text": "Welcome\nWelcome to Concepts of Paleoecology! This book is for teaching the concepts of Quaternary (past 2.58 million years) Paleoecology through Neotoma data.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Concepts of Paleoecology</span>"
    ]
  },
  {
    "objectID": "index.html#about-this-book",
    "href": "index.html#about-this-book",
    "title": "Concepts of Paleoecology",
    "section": "About This Book",
    "text": "About This Book\nThis book will cover the following\n\nFeatures\n\nClear explanations with diagrams and visuals\nInteractive code cells\nPractice",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Concepts of Paleoecology</span>"
    ]
  },
  {
    "objectID": "chapters/introduction.html#what-this-book-is",
    "href": "chapters/introduction.html#what-this-book-is",
    "title": "2  Introduction",
    "section": "2.1 What this Book is",
    "text": "2.1 What this Book is\nConcepts of Paleoecology based on Neotoma data"
  },
  {
    "objectID": "chapters/introduction.html#what-it-isnt",
    "href": "chapters/introduction.html#what-it-isnt",
    "title": "Introduction",
    "section": "What it isn’t",
    "text": "What it isn’t\nMethods of paleo, non Neotoma, deeper time",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#overview",
    "href": "chapters/chp1_stratplot.html#overview",
    "title": "Stratigraphic Plotting",
    "section": "",
    "text": "A hand-drawn pollen diagram of Tom Swamp, MA (Davis, 1958).",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#running-code",
    "href": "chapters/chp1_stratplot.html#running-code",
    "title": "3  Stratigraphic Plotting",
    "section": "3.2 Running Code",
    "text": "3.2 Running Code\nWhen you click the Render button a document will be generated that includes both content and the output of embedded code. You can embed code like this:\n\nlibrary(rioja)\n\nWarning: package 'rioja' was built under R version 4.3.2\n\n\nThis is rioja  1.0-6\n\ndata(aber)\nstrat.plot(aber$spec, scale.percent=TRUE, y.rev=TRUE)"
  },
  {
    "objectID": "chapters/chp1_stratplot.html",
    "href": "chapters/chp1_stratplot.html",
    "title": "Stratigraphic Plotting",
    "section": "",
    "text": "Overview\nIn 1980, the Quaternary paleoecologist John Birks wrote that computer-drawn pollen diagrams “are very useful for preliminary arrangement and interpretation of the data …. However, [they] are not sufficiently good for publication, and diagrams for publication must still be drafted by hand.” In the 2020s, all published pollen diagrams are computer-generated. One wonders whether the deliberate process of hand drawing encouraged earlier generations of paleoecologists to think more deeply about the patterns they were representing. But today’s users can rapidly reconfigure their diagrams in an iterative interpretation process and finally create highly customized visualizations using the array of software tools which now exist. Users can easily choose which taxa to include or exclude, change their order, and complement their diagrams with stratigraphically constrained clusters, among other things. In this chapter, we’ll focus on two tools for creating computer-generated stratigraphic plots: the R package rioja and the software Tilia.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#concepts-of-stratigraphic-plotting",
    "href": "chapters/chp1_stratplot.html#concepts-of-stratigraphic-plotting",
    "title": "Stratigraphic Plotting",
    "section": "Concepts of Stratigraphic Plotting",
    "text": "Concepts of Stratigraphic Plotting\nWhat are we talking about when we talk about pollen? There is no obvious way to back-calculate from a count of Poaceae pollen grains in a core section to the area, say, within 10 kilometers of a lake which is covered by grasses, without a mechanistic model that perfectly simulates the many paths that pollen may take from its varied sources to its deposition. In the absence of such a model, analysts tend to prefer to analyze pollen assemblages in terms of the proportion contributed within a given core section by any particular taxon. These relative abundances of pollen taxa are more ecologically meaningful, but their interpretation is not straightforward.\nFor one thing, proportions of pollen do not necessarily correspond to proportions of vegetation within some distance of a lake. Different kinds of plants produce pollen at differential rates, depending on their life strategies. Wind-blown pollinators (e.g., pines) must produce far more pollen than plants whose pollination is mediated by insects (e.g., apples). Pines are therefore overrepresented in the pollen record with respect to apples.\nAnother issue concerns spurious changes. Given a pollen record - rendered in percentages - that consists of solely pines and apples, an apparent decrease with depth in the proportion of pine pollen may represent\n\nan actual decrease in pine pollen counts,\nan increase in apple pollen counts,\nan increase in pine coupled with a greater increase in apple, or\na decrease in pine coupled with a lesser decrease in apple.\n\nFor these reasons, there have been attempts to render pollen not in terms of bare counts or relative abundances, but in absolute concentrations. Such concentrations have the benefit of avoiding the conceptual difficulties of spurious changes. However, somewhat like counts, they are difficult to interpret on their own, as well as highly variable, even at different points within the same lake for the same age.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#plotting",
    "href": "chapters/chp1_stratplot.html#plotting",
    "title": "Stratigraphic Plotting",
    "section": "Plotting",
    "text": "Plotting\nIn 1980, the Quaternary paleoecologist John Birks wrote that computer-drawn pollen diagrams “are very useful for preliminary arrangement and interpretation of the data …. However, [they] are not sufficiently good for publication, and diagrams for publication must still be drafted by hand.” In the 2020s, all published pollen diagrams are computer generated. One wonders whether the deliberate process of hand drawing encouraged earlier generations of paleoecologists to think more deeply about the patterns they were representing. But today’s users can rapidly reconfigure their diagrams in an iterative interpretation process and finally create highly customized visualizations using the array of software tools which now exist for stratigraphic plotting. In this chapter, we’ll focus on just two: the R package Rioja and the Tilia software.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#references",
    "href": "chapters/chp1_stratplot.html#references",
    "title": "Stratigraphic Plotting",
    "section": "References",
    "text": "References\n\nBirks Quaternary Paleoecology\nBirks, HH & Mathews, RW (1978). Studies in the vegetational history of Scotland V. Late Devensian and early Flandrian macrofossil stratigraphy at Abernethy Forest, Invernessshire. New Phytologist 80, 455-84.\nDavis 1958",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/introduction.html",
    "href": "chapters/introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "What this Book is\nConcepts of Paleoecology based on Neotoma data",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#plotting-with-rioja",
    "href": "chapters/chp1_stratplot.html#plotting-with-rioja",
    "title": "Stratigraphic Plotting",
    "section": "Plotting with Rioja",
    "text": "Plotting with Rioja\nIn order to plot some pollen data using the R package rioja, we need to call it using the library() function as below. The package comes with sample data - aber, “pollen stratigraphic data from Abernethy Forest, Scotland, spanning approximately 5500 - 12100 BP (from Birks & Mathews 1978)” - which we will plot. The aber object is a list with three components:\n\nspec - the actual pollen spectra, 49 rows of samples named by depth of 36 taxa arranged as columns, formatted as percentages\nages - a table mapping depths to uncalibrated and calibrated radiocarbon years, and\nnames - a table mapping taxa codes in spec to full taxonomic names and ecological group\n\n\nlibrary(rioja)\nlibrary(tidyverse) ## for easier data manipulation\n\ndata(aber)\n\n\nHow should the pollen data be formatted?\nLet’s take a closer look at spec. When we plot our pollen diagram, we will want to plot percentages of our data, not counts. The aber data should already be formatted as percentages. If you’re starting with counts, you can follow the instructions in this video or in the section below on formatting data for Tilia to make sure you convert your data to percentages properly.\nFor the aber data, let’s make sure the percentages aren’t obviously wrong. All the pollen percentages for any given row should sum to 100, since each individual pollen percentage is the relative abundance of that taxon at that depth. Let’s see if the data meet this expectation.\n\nrowSums(aber$spec)\n\n   300    305    310    315    320    325    330    335    340    345    350 \n 99.42  99.82 100.01  99.54  99.81  99.98  99.98  99.82  99.99  99.47  99.48 \n   355    357    360    363    365    367    370    373    375    405    410 \n 99.68  99.79  99.85  99.78  99.99  99.57  99.83  99.81  99.48  99.48  99.14 \n   415    420    425    430    435    440    445    450    455    460    465 \n 99.46  98.94  98.63  99.46  99.47  98.75  98.62  99.52  99.36  98.48  99.29 \n   470    475    480    485    490    500    505    510    515    520    525 \n 97.60  97.92  96.83  97.08  99.33  97.40  98.20  98.75  99.03  99.64  98.94 \n   530    535    540    545    550 \n 98.55  98.76 100.00  99.02  99.99 \n\n\nIt’s not perfect, but they add up more or less to 100 - good! Let’s actually try plotting the data now, using the strat.plot() function. The first argument of the function is the pollen spectra to be represented, and we add two additional arguments. Setting scale.percent to true scales the width of any taxon column to its abundance, and setting y.rev to true reverses the y axis, so larger values are below smaller values. This is a standard convention for stratigraphic plots, where age and depth increase as you proceed further down the core.\n\nstrat.plot(aber$spec, scale.percent=TRUE, y.rev=TRUE)\n\n\n\n\n\n\n\n\nIt looks pretty good! But one criticism we might make is that it’s a little hard to isolate any patterns of ecological change within the complexity. Betula seems to be dominant for a period before being superseded by Pinus sylvestris, but the other pollen taxa are hard to interpret. Many of them are such small percentages compared to Betula and Pinus sylvestris that it’s difficult to see what’s going on with them.\nBecause those smaller pollen percentages are so difficult to see and are only adding to the clutter at this point, we can choose remove them. This can be done systematically by eliminating all columns with a mean percentage of pollen less than, say, 3%. The following list comprehension achieves that.\n\naber_streamlined1  = aber$spec[colMeans(aber$spec)&gt;3]\n\n\nstrat.plot(aber_streamlined1, scale.percent=TRUE, y.rev=TRUE)\n\n\n\n\n\n\n\n\nThat looks even better! A clearer story is emerging: we see an early period dominated by herbs and grasses, followed by an intermediate period of birch and hazel, and ending with an era dominated by pine (pine pollen, at least!).\n\n\nWhen did these events occur?\nBut when did these events occur? We can’t simply assume that depth is one-to-one with time, because as the vegetation tracked by this sediment core changed, the rate of sedimentation may well have changed too. One can imagine that a prairie landscape suggested at the bottom of the core, perhaps grazed by large herds of animals, would have greater disturbance and sedimentation then a later forest landscape, where tree roots are keeping the soil solidly in place.\nLuckily, the aber dataset comes with a chronology that we can use in place of depth for our y axis.\n\nstrat.plot(aber_streamlined1, \n           yvar=aber$ages$`Age (years BP)`, \n           scale.percent=TRUE, \n           y.rev=TRUE)\n\n\n\n\n\n\n\n\nSubstituting time for depth doesn’t wildly change our understanding of the dynamics at Abernethy. One of the biggest changes is that, actually, that earliest ecological period lasted longer than we might have guessed from the depth profile, suggesting a slower sedimentation rate then. Still, having a chronology is generally preferably to going by bare depth, since it enables comparison to other sites and allows us to disentangle real ecological change from change in sedimentation rate.\n\n\nHow can less pollen-productive taxa be emphasized?\nEarlier, we grabbed just the most prevalent taxa at our site. But you may care about a taxon that doesn’t show up as abundantly in the pollen-record – perhaps because it’s insect-pollinated rather than wind-pollinated – but whose presences are meaningful, nonetheless. We can exaggerate the scale factor of these taxa in order to emphasize their importance. Let’s do so with the insect-pollinated taxa, Veronica.\nFirst, we’ll bind the column of Veronica from the original dataframe to our most prevalent taxa. We’ll set plot.poly to TRUE to plot polygons, since we’ll want to change the fill colors, and we’ll also make sure the names are correctly formatted by explicitly renaming the column headings.\n\naber_exag = aber$spec$VERONICA %&gt;% cbind(aber_streamlined1)\nnames(aber_exag) = c(\"Veronica\",\"Betula\",\"Pinus sylvestris\", \n                     \"Corylus\", \"Salix\", \"Juniperus\",\n                     \"Empetrum\",\"Gramineae\",\"Cyperaceae\",\n                     \"Artemisia\",\"Rumexaceae\")\n\nstrat.plot(aber_exag, \n           yvar=aber$ages$`Age (years BP)`,\n           scale.percent=TRUE, \n           y.rev=TRUE,\n           plot.poly=TRUE)\n\n\n\n\n\n\n\n\nYou can see above the non-exaggerated version of the graph. Because scale.percent is set to TRUE, Veronica appears very small. In order to exaggerate Veronica, the first thing we should do is set scale.percent to FALSE. By default now, all the columns will have equal width. We can further customize the taxa widths with the parameter graph.widths. This parameter takes a vector of proportions which should have the same length as the number of taxa being plotted and which should sum to one. The size of any proportion corresponds to the width of the respective taxon. Below, I’ll assign graph.widths a vector of 0.2 followed by ten 0.08s, so Veronica will take up 20% of the graph, and the other taxa will each take up 8%. These values can be further customized as the plotter sees fit.\nAnother option is to add in a logical vector as the value of the exag parameter, which will add in a shadow wherever exag is TRUE, the color of which shadow can be modified with the col.exag parameter.\n\nstrat.plot(aber_exag,\n           yvar=aber$ages$`Age (years BP)`,\n           scale.percent=FALSE,\n           graph.widths=c(0.2,rep(0.08,10)),\n           y.rev=TRUE, \n           plot.poly=TRUE,\n           col.poly=c(\"orange\",rep(\"yellow\",10)),\n           exag=c(TRUE,rep(FALSE,10)),\n           col.exag=\"red\")\n\n\n\n\n\n\n\n\nThat looks pretty good. Let’s remove the exaggeration color for now, and as long as we’re modifying colors, we might as well show some other color changes you can make. You can change the colors of the bars in the plot as well as the overarching line:\n\nstrat.plot(aber_exag,\n           yvar=aber$ages$`Age (years BP)`,\n           scale.percent=FALSE,\n           graph.widths=c(0.2,rep(0.08,10)),\n           y.rev=TRUE, \n           plot.poly=TRUE,\n           col.poly=c(\"orange\",rep(\"yellow\",10)),\n           col.line=\"red\",\n           col.bar=\"black\")\n\n\n\n\n\n\n\n\n\n\nHow can the order of taxa be rearranged?\nYou may want to group like taxa together by habit. This can be easily achieved by reordering the columns in the dataframe you’re plotting, as follows.\n\naber_reordered = aber_exag[,c(\"Betula\",\"Pinus sylvestris\", \n                               \"Corylus\",\"Salix\",\"Juniperus\",\n                               \"Veronica\",\"Empetrum\",\"Gramineae\",\n                               \"Cyperaceae\",\"Artemisia\",\"Rumexaceae\")]\n\n\n\nstrat.plot(aber_reordered,\n           yvar=aber$ages$`Age (years BP)`,\n           scale.percent=FALSE,\n           graph.widths=c(rep(0.08, 5), 0.2,\n                          rep(0.08, 5)),\n           y.rev=TRUE, \n           plot.poly=TRUE,\n           col.poly=c(rep(\"yellow\", 5),\"orange\",\n                      rep(\"yellow\", 5)),\n           col.line=\"black\",\n           col.bar=\"black\")\n\n\n\n\n\n\n\n\nNotice that we had to reconfigure the color vector when we reordered to make sure that Veronica stayed orange even as its position changed.\n\n\nHow do I add a stratigraphically constrained cluster diagram?\nYou can also add a CONISS diagram, which shows the results of a stratigraphically constrained cluster analysis of depth zones, to your stratigraphic plot in R. To do this, first you need to create a dissimilarity matrix from your data, which we’ll do with the R package vegan, and then use that matrix as an input to the rioja function chclust(), the output of which can be plugged into the stratigraphic plot.\n\nlibrary(vegan)\n\ndissim = vegdist(aber_exag)\n\naber_clust &lt;- chclust(dissim, method = \"coniss\")\n\n\n\nstrat.plot(aber_reordered,\n           yvar=aber$ages$`Age (years BP)`,\n           scale.percent=FALSE,\n           graph.widths=c(rep(0.08, 5), 0.2,\n                          rep(0.08, 5)),\n           y.rev=TRUE, \n           plot.poly=TRUE,\n           col.poly=c(rep(\"yellow\", 5),\"orange\",\n                      rep(\"yellow\", 5)),\n           col.line=\"black\",\n           col.bar=\"black\",\n           clust=aber_clust)\n\n\n\n\n\n\n\n\n\n\nSummary Panel\nrioja doesn’t have great options for making a summary plot of herbs versus trees, but it is possible. I do so below by adding all the herb percentages together and binding it to my plotting dataframe. Then I just make sure the column is named properly, change its color in the plot, and add in a background color to make it easier to see the negative space in that plot. Unfortunately, there’s no simple way to modify the background color of each curve in rioja separately. And notice that I have to modify my graph.widths parameter now that I’m adding a new “taxon” column to my diagram.\n\naber_exag = aber_exag %&gt;% \n  dplyr::mutate(all_herbs = Veronica + Empetrum +\n                  Gramineae + Cyperaceae +\n                  Artemisia + Rumexaceae)\n\naber_reordered = aber_reordered %&gt;% cbind(aber_exag$all_herbs)\n\nnames(aber_reordered)[12] = \"Herbs versus Trees\"\n\n\n\nstrat.plot(aber_reordered,\n           yvar=aber$ages$`Age (years BP)`,\n           scale.percent=FALSE,\n           graph.widths=c(rep(0.08, 5), 0.12,\n                          rep(0.08, 6)),\n           y.rev=TRUE, \n           plot.poly=TRUE,\n           col.poly=c(rep(\"yellow\", 5),\"orange\",\n                      rep(\"yellow\", 5)),\n           col.line=\"black\",\n           col.bar=\"black\",\n           col.bg=\"tan\",\n           clust=aber_clust)\n\n\n\n\n\n\n\n\n\n\nHow can the diagram be further refined?\nWe made a pretty sophisticated plot in rioja. To make further aesthetic changes, you might want to export your graphic as a .emf file and manipulate it further in Adobe Illustrator.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#plotting-with-tilia",
    "href": "chapters/chp1_stratplot.html#plotting-with-tilia",
    "title": "Stratigraphic Plotting",
    "section": "Plotting with Tilia",
    "text": "Plotting with Tilia\nTilia is a software program developed by Eric Grimm which enables users to upload their data into Neotoma, and also allows users to develop pollen diagrams, using Neotoma data or their own data. You can install Tilia by following the directions on this page.\n\nFormatting data\nIn order to plot pollen data from a non-Neotoma source in Tilia, there is a preliminary data-formatting step. We want to convert our pollen counts into pollen percentages, which we will plot directly in Tilia. In order to calculate pollen percentages, we need to sum all the pollen counted at each sample depth and then divide each individual count by the count sum at that depth, as shown in the following video.\n\n\nYour browser does not support the video tag. \n\n\nPasting data into Tilia\nOnce the data are properly formatted, they can be pasted into a Tilia spreadsheet. In Tilia, each row corresponds to a taxon, and each column corresponds to a sample depth. Those sample depths can be indexed either as depths, ages, or both. Also, Tilia provides a “Group” column where the habit or ecological group of the taxon in question can be noted.\n\n\nYour browser does not support the video tag. \n\n\nModifying Pollen Diagram\nOnce you’ve made the pollen diagram, there are some convenient ways to modify it in Tilia. These include\n\nrearranging columns\ndeleting columns that you don’t care about, and\nexaggerating the scale of taxa that exhibit small but important changes.\n\n\n\nYour browser does not support the video tag. \n\n\nVisualizing Summary Dynamics\nAnother addition to your plot that Tilia allows for is the creation of a summary panel that shows the broad vegetation dynamics, say, between herbs and trees. The following video shows how to create that summary panel.\n\n\nYour browser does not support the video tag. \n\n\nCluster Analysis\nLastly, Tilia makes it easy to insert a stratigraphically constrained cluster analysis (CONISS) into your plot. Watch this video to learn how.\n\n\nYour browser does not support the video tag.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  },
  {
    "objectID": "chapters/chp1_stratplot.html#conclusion",
    "href": "chapters/chp1_stratplot.html#conclusion",
    "title": "Stratigraphic Plotting",
    "section": "Conclusion",
    "text": "Conclusion\nIn this module, we’ve walked through how to start building stratigraphic plots (with a focus on pollen data) using the R library Rioja and Eric Grimm’s Tilia. We hope that it has been helpful. Please reach out with any questions.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Stratigraphic Plotting</span>"
    ]
  }
]